db.createCollection("mr1")
db.mr1.insert([{prod_id:"a1",price:400,status:"a"},{prod_id:"b1",price:300,status:"d"},{prod_id:"a1",price:200,status:"c"},{prod_id:"c1",price:200,status:"c"},{prod_id:"b1",price:700,status:"a"},{prod_id:"b1",price:800,status:"a"},{prod_id:"c1",price:200,status:"c"}])
db.mr1.find().pretty()
db.mr1.mapReduce(function(){emit(this.prod_id,this.price)},function(key,values){return Array.sum(values)},{query:{status:"a"},out:"total_price"}).find().pretty()
db.mr1.mapReduce(function(){emit(this.prod_id,this.price)},function(key,values){return Array.avg(values)},{query:{status:"a"},out:"mr_avg"}).find().pretty()
db.mr1.mapReduce(function(){emit(this.prod_id,this.price)},function(key,values){return Math.min.apply(Math,values)},{query:{status:"a"},out:"mr_min"}).find().pretty()
db.mr1.mapReduce(function(){emit(this.prod_id,this.price)},function(key,values){return Math.max.apply(Math,values)},{query:{status:"a"},out:"mr_max"}).find().pretty()
db.mr1.mapReduce(function(){emit(this.prod_id,this.price)},function(key,values){return Math.max.apply(Math,values)},{out:"mr_max"}).find().pretty()
db.mr1.mapReduce(function(){emit(this.prod_id,this.price)},function(key,values){return Math.min.apply(Math,values)},{out:"mr_min"}).find().pretty()
db.mr1.mapReduce(function(){emit(this.prod_id,this.price)},function(key,values){return Array.avg(values)},{out:"mr_avg"}).find().pretty()